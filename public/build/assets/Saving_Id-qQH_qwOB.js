import{j as e,r as l,V as p,U as w}from"./app-CV0FOCES.js";import{F as O,C as y}from"./FarstViewAvatar-S6Mj4T-5.js";import{I as E}from"./InputPrice-Bfsud5bd.js";function M({className:s="",title:o,type:a,...n}){return e.jsx("div",{className:"relative flex flex-nowrap items-center justify-center gap-1 w-auto "+s,children:e.jsx("h3",{className:"inline-block py-1 w-auto text-lg font-bold leading-none focus:outline-none "+s,children:o})})}function $({amount:s,total:o,size:a}){const t=s/o*100,c={small:"h-1",large:"h-6"}[a];return e.jsx("div",{className:"overflow-hidden w-full bg-gray rounded-sm "+c,children:e.jsx("div",{className:"h-full bg-gradation",style:{width:`${t}%`,transition:"width 0.5s ease"}})})}function F({type:s="submit",className:o="",disabled:a,...n}){const[i,t]=l.useState(!1),c=()=>{i||(t(!0),setTimeout(()=>t(!1),500))},d=u=>{c(),n.onClick&&n.onClick(u)};return e.jsxs("button",{...n,type:s,onClick:d,className:`button-savig inline-flex flex-col items-center justify-center gap-0 rounded-full w-20 h-20 border border-primary bg-primary text-sm font-bold uppercase tracking-normal text-white shadow-sm transition duration-150 ease-in-out hover:bg-gradation-blue hover:border-blue hover:text-white focus:outline-none focus:ring-2 focus:ring-blue focus:ring-offset-2 ${a&&"opacity-25 pointer-events-none"} `+o,disabled:a,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 512 512",className:`object-contain ${i?"animate-bounceSvg":""}`,children:e.jsx("path",{d:"M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2c0 0 0 0 0 0s0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4l0 3.4 0 5.7 0 26.3zm32 0l0-32 0-25.9c19-4.2 36.5-9.5 52.1-16c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 10.5-5 21-14.9 30.9c-16.3 16.3-45 29.7-81.3 38.4c.1-1.7 .2-3.5 .2-5.3zM192 448c56.2 0 108.6-9.4 148.1-25.9c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 44.2-86 80-192 80S0 476.2 0 432l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448z"})}),"ちょきん"]})}function R({className:s="",onChange:o,onSave:a,inputName:n}){const[i,t]=l.useState(0),c=u=>{const f=Number(u.target.value);t(f),o(f)};l.useRef(null);const d=()=>{a(i)};return e.jsxs("div",{className:`flex items-center justify-start flex-col gap-1 ${s}`,children:[e.jsx("div",{className:"flex items-center justify-start gap-1 mb-1",children:e.jsx(E,{name:n,value:i,onChange:c})}),e.jsx(F,{onClick:d})]})}const U=()=>{const[s,o]=l.useState(new Set);return{openIndexes:s,handleToggle:n=>{o(i=>{const t=new Set(i);return t.has(n)?t.delete(n):t.add(n),t})}}};function Q(){const s=p().props.auth.user,{statuses:o}=p().props,a=(o==null?void 0:o[s.id])??null,{savings:n}=p().props;if(!n)return e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"flex items-center justify-center gap-2 w-full h-screen",children:e.jsx(w,{href:"./registration",className:"flex items-center justify-center rounded-md border border-transparent bg-gradation min-w-32 max-w-52 px-4 py-2 max-h-10 text-sm font-bold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-gradation-blue focus:bg-gradation focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 active:bg-gradation",children:"初回登録した？"})})})});Object.values(n);const{histories:i}=p().props,t={saving_id:n.saving_id,user_id:n.user_id,comment_id:n.comment_id,goal_group_id:n.goal_group_id,goal_name:n.goal_name,goal_amount:n.goal_amount,goal_date:n.goal_date,goal_level:n.goal_level,goal_images:n.goal_images,is_shared:n.is_shared,memo:n.memo};if(console.log("saving.saving_id->"+t.saving_id),console.log("saving.user_id->"+t.user_id),console.log("saving.comment_id->"+t.comment_id),console.log("saving.goal_group_id->"+t.goal_group_id),console.log("saving.goal_name->"+t.goal_name),console.log("saving.goal_amount->"+t.goal_amount),console.log("saving.goal_level->"+t.goal_level),console.log("saving.goal_images->"+t.goal_images),console.log("saving.is_shared->"+t.is_shared),console.log("saving.memo->"+t.memo),!a||!i||!t)return e.jsx("div",{children:e.jsx("p",{children:"ステータスが見つかりません。"})});const c=a.saving,d=a.investment,u=a.essential,f=a.extravagance,x=a.donation,h=(g,v,H)=>v.filter(m=>m.goal_group_id===g).map(m=>parseFloat(String(m.amount_saved))).reduce((m,A)=>m+A,0),[V,S]=l.useState(0),[q,N]=l.useState(0),C=g=>{S(g)},[_,k]=l.useState(h(t.saving_id,i)),I=g=>{const v=g+h(t.goal_group_id,i);N(v),k(v)},j=x;let r=j;j<1e3?r=1:r<2e3?r=2:r<3e3?r=3:r<4e3?r=4:r<5e3&&(r=5);const b={id:s.id,name:s.name,savings:c,investment:d,essential:u,extravagance:f,planned_extravagance:x,level:r,donation:x,avatar:"https://borderlesss.sakura.ne.jp/ss1/assets/images/photo-noimages.jpg"},T=b.avatar;U();const P=new Date(t.goal_date).toISOString().split("T")[0],B=document.querySelector("meta[name='csrf-token']"),z=l.useRef(B.content),D=new Date().toISOString().split("T")[0];return e.jsx("div",{className:"overflow-hidden flex items-center justify-center w-full h-full",children:e.jsxs("div",{className:"contents_box overflow-auto flex flex-col gap-5 pb-5 w-full md:max-w-[64vmin] h-screen md:border-solid border-0 md:border-8 md:border-black md:rounded-2xl ",children:[e.jsx(O,{UserData:b,category:1,fvImages:T}),e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx("ul",{className:"px-4",children:e.jsx("li",{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:P}),e.jsx(M,{type:1,title:t.goal_name}),e.jsxs("form",{action:"./update",method:"POST",children:[e.jsx("input",{type:"hidden",name:"_token",value:z.current}),e.jsx("input",{type:"hidden",name:"user_id",value:s.id}),e.jsx("input",{type:"hidden",name:"category",value:1}),e.jsx("input",{type:"hidden",name:"goal_group_id",value:t.saving_id}),e.jsx("input",{type:"hidden",name:"date_saved",value:D}),e.jsx("input",{type:"hidden",name:"saving_id",value:t.saving_id}),e.jsxs("div",{className:"relative w-full h-auto mt-2",children:[e.jsx($,{size:"large",total:t.goal_amount,amount:_}),e.jsxs("p",{className:"absolute top-1/2 right-2 translate-y-[-50%] z-10 flex items-center justify-center text-primary font-bold mix-blend-difference",children:[e.jsx(y,{price:_}),"/",e.jsx(y,{price:t.goal_amount})]})]}),e.jsx(R,{inputName:"amount_saved",className:"mt-5",onChange:C,onSave:I})]}),e.jsx(w,{href:"./userpage",className:"flex items-center justify-center rounded-md border border-transparent bg-gradation min-w-32 max-w-52 mt-10 mx-auto px-4 py-2 max-h-10 text-sm font-bold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-gradation-blue focus:bg-gradation focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 active:bg-gradation",children:"ユーザーページ"})]})})})})]})})}export{Q as default};
