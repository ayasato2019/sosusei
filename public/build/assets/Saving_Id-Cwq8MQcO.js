import{j as e,r as c,V as f,U as A}from"./app-ClgLaYcD.js";import{F as D,C as b}from"./FarstViewAvatar-B_us2zp5.js";import{I as E}from"./InputPrice-DHEVx4C0.js";function M({className:s="",title:r,type:a,...o}){return e.jsx("div",{className:"relative flex flex-nowrap items-center justify-center gap-1 w-auto "+s,children:e.jsx("h3",{className:"inline-block py-1 w-auto text-lg font-bold leading-none focus:outline-none "+s,children:r})})}function O({amount:s,total:r,size:a}){const t=s/r*100,i={small:"h-1",large:"h-6"}[a];return e.jsx("div",{className:"overflow-hidden w-full bg-gray rounded-sm "+i,children:e.jsx("div",{className:"h-full bg-gradation",style:{width:`${t}%`,transition:"width 0.5s ease"}})})}function $({type:s="submit",className:r="",disabled:a,...o}){const[n,t]=c.useState(!1),i=()=>{n||(t(!0),setTimeout(()=>t(!1),500))},l=u=>{i(),o.onClick&&o.onClick(u)};return e.jsxs("button",{...o,type:s,onClick:l,className:`button-savig inline-flex flex-col items-center justify-center gap-0 rounded-full w-20 h-20 border border-primary bg-primary text-sm font-bold uppercase tracking-normal text-white shadow-sm transition duration-150 ease-in-out hover:bg-gradation-blue hover:border-blue hover:text-white focus:outline-none focus:ring-2 focus:ring-blue focus:ring-offset-2 ${a&&"opacity-25 pointer-events-none"} `+r,disabled:a,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 512 512",className:`object-contain ${n?"animate-bounceSvg":""}`,children:e.jsx("path",{d:"M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2c0 0 0 0 0 0s0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4l0 3.4 0 5.7 0 26.3zm32 0l0-32 0-25.9c19-4.2 36.5-9.5 52.1-16c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 10.5-5 21-14.9 30.9c-16.3 16.3-45 29.7-81.3 38.4c.1-1.7 .2-3.5 .2-5.3zM192 448c56.2 0 108.6-9.4 148.1-25.9c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 44.2-86 80-192 80S0 476.2 0 432l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448z"})}),"ちょきん"]})}function F({className:s="",onChange:r,onSave:a,inputName:o}){const[n,t]=c.useState(0),i=u=>{const g=Number(u.target.value);t(g),r(g)};c.useRef(null);const l=()=>{a(n)};return e.jsxs("div",{className:`flex items-center justify-start flex-col gap-1 ${s}`,children:[e.jsx("div",{className:"flex items-center justify-start gap-1 mb-1",children:e.jsx(E,{name:o,value:n,onChange:i})}),e.jsx($,{onClick:l})]})}const R=()=>{const[s,r]=c.useState(new Set);return{openIndexes:s,handleToggle:o=>{r(n=>{const t=new Set(n);return t.has(o)?t.delete(o):t.add(o),t})}}};function L(){const s=f().props.auth.user,{statuses:r}=f().props,a=(r==null?void 0:r[s.id])??null,{savings:o}=f().props,n=o?Object.values(o):[],t={saving_id:Number(n[0]),user_id:Number(n[1]),comment_id:Number(n[2]),goal_group_id:Number(n[3]),goal_name:String(n[4]),goal_amount:Number(n[5]),goal_date:String(n[6]),goal_level:Number(n[7]),goal_images:String(n[8]),is_shared:!!n[9],memo:String(n[10])},{histories:i}=f().props;if(!a||!o||!i||!t)return e.jsx("div",{children:e.jsx("p",{children:"ステータスが見つかりません。"})});const l=a.saving,u=a.investment,g=a.essential,w=a.extravagance,x=a.donation,h=(d,p,G)=>p.filter(m=>m.goal_group_id===d).map(m=>parseFloat(String(m.amount_saved))).reduce((m,z)=>m+z,0),[U,S]=c.useState(0),[V,_]=c.useState(0),y=d=>{S(d)},[v,N]=c.useState(h(t.saving_id,i)),C=d=>{const p=d+h(t.goal_group_id,i);_(p),N(p)},j={id:s.id,name:s.name,savings:l,investment:u,essential:g,extravagance:w,planned_extravagance:x,level:0,donation:x,avatar:"https://borderlesss.sakura.ne.jp/ss1/assets/images/photo-noimages.jpg"},k=j.avatar;R();const I=t.goal_date.toString().split("T")[0],P=document.querySelector("meta[name='csrf-token']"),T=c.useRef(P.content),B=new Date().toISOString().split("T")[0];return e.jsx("div",{className:"overflow-hidden flex items-center justify-center w-full h-full",children:e.jsxs("div",{className:"contents_box overflow-auto flex flex-col gap-5 pb-5 w-full md:max-w-[64vmin] h-screen md:border-solid border-0 md:border-8 md:border-black md:rounded-2xl ",children:[e.jsx(D,{UserData:j,category:1,fvImages:k}),e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx("ul",{className:"px-4",children:e.jsx("li",{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:I}),t.goal_level===1?e.jsx(M,{type:1,title:t.goal_name}):"",e.jsxs("form",{action:"/update",method:"POST",children:[e.jsx("input",{type:"hidden",name:"_token",value:T.current}),e.jsx("input",{type:"hidden",name:"user_id",value:s.id}),e.jsx("input",{type:"hidden",name:"category",value:1}),e.jsx("input",{type:"hidden",name:"goal_group_id",value:t.saving_id}),e.jsx("input",{type:"hidden",name:"date_saved",value:B}),e.jsx("input",{type:"hidden",name:"saving_id",value:t.saving_id}),e.jsxs("div",{className:"relative w-full h-auto mt-2",children:[e.jsx(O,{size:"large",total:t.goal_amount,amount:v}),e.jsxs("p",{className:"absolute top-1/2 right-2 translate-y-[-50%] z-10 flex items-center justify-center text-primary font-bold mix-blend-difference",children:[e.jsx(b,{price:v}),"/",e.jsx(b,{price:t.goal_amount})]})]}),e.jsx(F,{inputName:"amount_saved",className:"mt-5",onChange:y,onSave:C})]}),e.jsx(A,{href:"/userpage",className:"flex items-center justify-center rounded-md border border-transparent bg-gradation min-w-32 max-w-52 mt-10 mx-auto px-4 py-2 max-h-10 text-sm font-bold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-gradation-blue focus:bg-gradation focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 active:bg-gradation",children:"ユーザーページ"})]})})})})]})})}export{L as default};
